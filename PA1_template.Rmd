---
title: "Reproducible Research: Peer Assessment 1"
author: "Oscar Pe√±a del Rio"
email: "oscar.pdr@gmail.com"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

Uses the unzip() function to extract the CSV file and loads it into **activity_data** dataframe.

```{r}
unzipped_file <- unzip("activity.zip")
activity_data <- read.csv(unzipped_file)
```

## What is mean total number of steps taken per day?

1. Calculate the total number of steps taken per day, omitting *NA* values. Generate histogram with the values.

```{r first_histogram, fig.width=6, fig.height=4}
steps_by_date <- aggregate(steps ~ date, activity_data, sum, na.action = na.omit)
hist(steps_by_date$steps,
     main="Histogram of steps taken per day",
     xlab="Steps interval",
     col="darkolivegreen1"
)
```

2. Calculate and report the mean and median of the total number of steps taken per day

```{r}
mean(steps_by_date$steps)
median(steps_by_date$steps)
```

## What is the average daily activity pattern?

1. Make a time series plot of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis).

```{r averages_plot, fig.width=6, fig.height=5}
steps_by_interval <- aggregate(steps ~ interval, activity_data, mean, na.action = na.omit)
plot(steps_by_interval$interval, steps_by_interval$steps, 
     type="l",
     main="Time-series pattern of each 5 minute interval",
     xlab="5 minute interval",
     ylab="Average number of steps"
)
```

2. 5-minute interval, on average across all the days in the dataset, which contains the maximum number of steps

```{r}
steps_by_interval[steps_by_interval$steps==max(steps_by_interval$steps),]
```

## Imputing missing values

1. Calculate and report the total number of missing values in the dataset

```{r}
sum(is.na(activity_data$steps))
```

2. Create a new dataset that is equal to the original dataset but with the missing data filled in.

```{r}
steps_data <- data.frame(activity_data$steps)
steps_data[is.na(steps_data),] <- ceiling(tapply(activity_data$steps, activity_data$interval, mean, na.rm=TRUE))
filled_activity_data <- cbind(steps_data, activity_data[,2:3])
```

3. Make a histogram of the total number of steps taken each day.

```{r second_histogram, fig.width=6, fig.height=4}
filled_steps_by_date <- aggregate(activity_data.steps ~ date, filled_activity_data, sum)
hist(filled_steps_by_date$activity_data.steps,
     main="Histogram of steps taken per day",
     xlab="Steps interval",
     col="darkolivegreen1"
)
```

4. Calculate and report the mean and median total number of steps taken per day.

```{r}
mean(filled_steps_by_date$activity_data.steps)
median(filled_steps_by_date$activity_data.steps)
```

The **mean** and the **median** are quite similar in both cases (that is, with the original data and after the simple *NA* values removal step), so its impact can be considered low.

## Are there differences in activity patterns between weekdays and weekends?
